---
date: '2022-05-05T12:36:50+08:00'
lastmod: '2022-09-05T09:00:37+08:00'
tags:
  - 高并发
---

# 03丨系统设计目标（一）：如何提升系统性能？

> [!question] 互联网常说的三高是指？
>
> 1. 高并发
> 2. 高性能
> 3. 高可用

## 1 高并发系统设计的三大目标

> [!question] 高并发系统设计的三大目标？
>
> 1. 高性能
> 2. 高可用
> 3. 可扩展

**高并发**：指运用设计手段让系统能够处理更多的用户并发请求，也就是承担更大的流量。它是一切架构设计的背景和前提，脱离了它去谈性能和可用性是没有意义的。

而**性能和可用性**，是我们实现高并发系统设计必须考虑的因素。

**可扩展性**，它同样是高并发系统设计需要考虑的因素。为什么呢？

流量分为平时流量和峰值流量两种：

1. 峰值流量可能会是平时流量的几倍甚至几十倍，在应对峰值流量的时候，我们通常需要在架构和方案上做更多的准备。
2. 而易于扩展的系统能在短时间内迅速完成扩容，更加平稳地承担峰值流量。

> [!question] 如何提升系统的性能？

## 2 性能优化原则

- 首先，性能优化一定不能盲目，一定是问题导向的
- 其次，性能优化也遵循“八二原则”
- 再次，性能优化也要有数据支撑：在优化过程中，你要时刻了解你的优化让响应时间减少了多少，提升了多少的吞吐量。
- 最后，性能优化的过程是持续的。

## 3 性能的度量指标

对于性能我们需要有度量的标准，有了数据才能明确目前存在的性能问题，也能够用数据来评估性能优化的效果。所以**明确性能的度量指标十分重要**。

- 平均值
- 最大值
- **分位值**

**通常使用分位值，平均值也做参考**：

分位值有很多种，比如 90 分位、95 分位、75 分位。分位值越大，对于慢请求的影响就越敏感。分位值是最适合作为时间段内，响应时间统计值来使用的，在实际工作中也应用最多。除此之外，平均值也可以作为一个参考值来使用。

> [!question]  响应时间究竟控制在多长时间比较合适呢？

从用户使用体验的角度来看：200ms 是第一个分界点，而 1s 是另外一个分界点。

健康系统的 **99 分位值的响应时间通常需要控制在 200ms 之内**，而不超过 1s 的请求占比要在 99.99% 以上。

## 4 高并发下的性能优化

主要有两种思路：一种是提高系统的处理核心数，另一种是减少单次任务的响应时间。

1. 提高系统的处理核心数

![[03丨系统设计目标（一）：如何提升系统性能？_image_1.png]]
评估系统性能时通常需要做**压力测试**，目的就是找到系统的“拐点”，从而知道系统的承载能力，也便于找到系统的瓶颈，持续优化系统性能。

2. 减少单次任务响应时间

想要减少任务的响应时间，首先要看你的系统是 CPU 密集型还是 IO 密集型的，因为不同类型的系统性能优化方式不尽相同。

CPU 密集型系统：需要处理大量的 CPU 运算，那么选用更高效的算法或者减少运算次数就是这类系统重要的优化手段。
IO 密集型系统：指的是系统的大部分操作是在等待 IO 完成，这里 IO 指的是磁盘 IO 和网络 IO。我们熟知的系统大部分都属于 IO 密集型，比如数据库系统、缓存系统、Web 系统。

发现这类性能瓶颈的手段主要有两类。

1. 采用工具：Linux 的工具集很丰富，完全可以满足你的优化需要，比如网络协议栈、网卡、磁盘、文件系统、内存，等等。一些开发语言还有针对语言特性的分析工具，如  `go pprof`
2. 通过监控来发现性能问题。

## 5 总结

1. **数据优先**，你做一个新的系统在上线之前一定要把性能监控系统做好；
2. **掌握一些性能优化工具和方法**，这就需要在工作中不断的积累；
3. **计算机基础知识很重要**，比如说网络知识、操作系统知识等等，掌握了基础知识才能让你在优化过程中抓住性能问题的关键，也能在性能优化过程中游刃有余。
